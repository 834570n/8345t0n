Exploitable Locations
- Core functionality
- Peripheral behavior 
    - Off-site links
    - Error messages
    - Admin and logging features
    - Redirects
- Core security mechanisms
    - Session handling
    - Authentication
    - Access controls
    - Supporting logic
        - User registration
        - Password changes
        - Account recovery
- Locations with user-supplied input
    - URL
    - Query string parameters
    - POST data
    - Cookies
- Client-side technology
    - Forms
    - Scripts
    - Thick-client components
        - Java applets
        - ActiveX controls
        - Flash
    - Cookies
- Server-side technology
    - Static and dynamic pages
    - Request parameters
    - SSL usage
    - Web server software
    - Database integration
    - E-mail systems
    - Other backend components
- Internal structure details on functionality of server-side application
    - Mechanisms to deliver functionality and behavior that are visible to client

* PAGE 98
ENTRY POINTS FOR USER INPUT
- URL up to query string marker
- URL query string
- Parameters submitted in body of POST request
    - Referer
    - User-agent
    - X-Forwarded-For
- Cookies
- HTTP headers

DOM XSS example payload
<iframe src="javascript:alert(`xss`)">

Dont Repeat Yourself - Every piece of knowledge must have a single, unambiguous, authoritative representation in the system
    - Provide different input in the "repeat password" field

Mapping the Attack Surface
- Client-side validation        Checks may not be replicated on the server
- Database interaction          SQL injection
- File upload/download          Path traversal, stored XSS
- Display of user-supplied data XSS
- Dynamic redirects             Redirection and header injection
- Social networking features    Username enumeration, stored XSS
- Login                         Username enumeration, weak passwords, brute force
- Multistage login              Logic flaws
- Session state                 Predictable tokens, insecure handling of tokens
- Access controls               Horizontal and vertical privesc
- User impersonation functions  Privesc
- Cleartext communications      Session hijacking, capture of creds and other sensitive data
- Off-site links                Leakage of query string parameters in Referer header
- Interfaces to ext systems     Shortcuts in handling of sessions/access controls
- Error messages                Information leakage
- E-mail interaction            E-mail/command injection
- Native code components        Buffer overflow
- Indentifiable web server      Common configuration weaknesses, known software bugs

